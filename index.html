
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;json&quot;,&quot;ruby&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="json">json</a>
              <a href="#" data-language-name="ruby">ruby</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
          </li>
          <li>
            <a href="#authentication" class="toc-h1 toc-link" data-title="Authentication">Authentication</a>
          </li>
          <li>
            <a href="#errors" class="toc-h1 toc-link" data-title="Errors">Errors</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#the-error-object" class="toc-h2 toc-link" data-title="Errors">The error object</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#investments" class="toc-h1 toc-link" data-title="Investments">Investments</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#attributes" class="toc-h2 toc-link" data-title="Investments">Attributes</a>
                  </li>
                  <li>
                    <a href="#relationships" class="toc-h2 toc-link" data-title="Investments">Relationships</a>
                  </li>
                  <li>
                    <a href="#status" class="toc-h2 toc-link" data-title="Investments">Status</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#process" class="toc-h3 toc-link" data-title="Investments">Process</a>
                          </li>
                          <li>
                            <a href="#process-template" class="toc-h3 toc-link" data-title="Investments">Process Template</a>
                          </li>
                          <li>
                            <a href="#process-category" class="toc-h3 toc-link" data-title="Investments">Process Category</a>
                          </li>
                          <li>
                            <a href="#tasks" class="toc-h3 toc-link" data-title="Investments">Tasks</a>
                          </li>
                          <li>
                            <a href="#notifications" class="toc-h3 toc-link" data-title="Investments">Notifications</a>
                          </li>
                          <li>
                            <a href="#process-options" class="toc-h3 toc-link" data-title="Investments">Process Options</a>
                          </li>
                      </ul>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#developer-reference" class="toc-h1 toc-link" data-title="Developer Reference">Developer Reference</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#using-the-right-serializer-amp-adapter" class="toc-h2 toc-link" data-title="Developer Reference">Using the right serializer &amp; adapter</a>
                  </li>
                  <li>
                    <a href="#limiting-what-fields-are-sent-back" class="toc-h2 toc-link" data-title="Developer Reference">Limiting what fields are sent back</a>
                  </li>
                  <li>
                    <a href="#including-other-relationships" class="toc-h2 toc-link" data-title="Developer Reference">Including other relationships</a>
                  </li>
                  <li>
                    <a href="#rendering-errors" class="toc-h2 toc-link" data-title="Developer Reference">Rendering Errors</a>
                  </li>
              </ul>
          </li>
      </div>
        <ul class="toc-footer">
            <li><a href='#'>Example Link</a></li>
            <li><a href='https://github.com/tripit/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p>Currently, we&#39;re at version 1 of the Selequity API. Soon, we will likely
need to integrate with external services, as well as creating greater
internal consistency. There are several tasks between here and there:</p>

<ul>
<li>defining a consistent json schema</li>
<li>documentation around the api</li>
<li>building out the endpoints</li>
</ul>

<p>Thus, alongside other refactoring efforts, we&#39;re going to slowly
convert, piece by piece, resource by resource, the current codebase from
version 1 to our latest understanding of the domain and use cases in
version 2.</p>

<p>This API follows the <a href="http://jsonapi.org/">json api</a> specification.</p>
<h1 id='authentication'>Authentication</h1>
<p>This api is currently only available from inside the app itself,
although we will certainly be opening it up later. This documentation is
in preparation for that point.</p>
<h1 id='errors'>Errors</h1>
<p>Selequity uses conventional HTTP response codes to indicate the success or failure of an API request. In general, codes in the 2xx range indicate success, codes in the 4xx range indicate an error that failed given the information provided (e.g., a required parameter was omitted, a charge failed, etc.), and codes in the 5xx range indicate an error with Selequity&#39;s servers (these are rare).</p>

<p>Generally, responses will only contain one error, but in some cases
(such as complex validations) there might be many errors. Generally, the
HTTP response code will match the errors, but in cases where that&#39;s not
true, we need to make sure to document them here.</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request -- The request was unacceptable, often due to missing a required parameter.</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized -- No valid API key provided.</td>
</tr>
<tr>
<td>402</td>
<td>Request Failed -- The parameters were valid but the request failed.</td>
</tr>
<tr>
<td>404</td>
<td>Not Found -- The requested resource doesn&#39;t exist.</td>
</tr>
<tr>
<td>429</td>
<td>Too Many Requests -- Too many requests hit the API too quickly.</td>
</tr>
<tr>
<td>500, 502, 503, 504</td>
<td>Internal Server Error -- We had a problem with our server. Try again later.</td>
</tr>
</tbody></table>
<h2 id='the-error-object'>The error object</h2>
<p>FIELDS</p>
<pre class="highlight json tab-json"><code><span class="err">//</span><span class="w"> </span><span class="err">HTTP</span><span class="w"> </span><span class="mi">422</span><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="s2">"errors"</span><span class="p">:[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">422</span><span class="p">,</span><span class="w">
      </span><span class="s2">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RecordInvalid"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Record Invalid"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"detail"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Minimum investment cannot exceed maximum investment."</span><span class="p">,</span><span class="w">
      </span><span class="s2">"parameter"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
          </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"investments"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>A response will never contain both a data key and an errors key.</p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>status</td>
<td>integer</td>
<td>the HTTP status code applicable to this problem, expressed as a string value.</td>
</tr>
<tr>
<td>code</td>
<td>string</td>
<td>an application-specific error code, expressed as a string value.</td>
</tr>
<tr>
<td>title</td>
<td>string</td>
<td>a short, human-readable summary of the problem that SHOULD NOT change from occurrence to occurrence of the problem, except for purposes of localization.</td>
</tr>
<tr>
<td>detail</td>
<td>string</td>
<td>a human-readable explanation specific to this occurrence of the problem. Like title, this field’s value can be localized.</td>
</tr>
<tr>
<td>parameter</td>
<td>string</td>
<td>extra information about any relevant parameters</td>
</tr>
<tr>
<td>meta</td>
<td>string</td>
<td>a meta object containing non-standard meta-information about the error.</td>
</tr>
</tbody></table>
<h1 id='investments'>Investments</h1>
<p>Investments are how deals get funded. Each investment can have a variety
of concurrent processes running on it at the same time.</p>
<h2 id='attributes'>Attributes</h2><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"25"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"investments"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"deal_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"workflow_state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"complete"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-04-12T13:27:18.317Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-04-12T13:27:18.317Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"accredify_token"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"accreditation_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"deal_terms"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"documents_understood"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"titled"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Charles George III"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"completed_on"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"will_be_rejected"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"pre_reject_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"fa_investment_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"fa_investor_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"accreditation_subtype"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"project_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
    </span><span class="s2">"suitability_document_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"investment_document_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"phone"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"investor_type"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"suitability_response_document_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"is_fully_accredited"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"vi_identifier"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"vi_user_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"vi_verification_request_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"vi_investor_url"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"vi_verification_status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unverified"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"relationships"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"deal"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"address"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>FIELDS</p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>Unique identifier for the object.</td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td>String representing the object&#39;s type. Objects of the same type share the same value.</td>
</tr>
<tr>
<td>titled</td>
<td>string</td>
<td>String representing what specific investment vehicle owns this investment.</td>
</tr>
<tr>
<td>amount</td>
<td>positive integer</td>
<td>A positive integer representing how much this investment will supply.</td>
</tr>
<tr>
<td>created_at</td>
<td>timestamp</td>
<td>Time at which the object was created. Stored in ISO8601, and transmitted in UTC.</td>
</tr>
<tr>
<td>completed_on</td>
<td>timestamp</td>
<td>Time at which the investment was completed. Stored in ISO8601, and transmitted in UTC.</td>
</tr>
</tbody></table>
<h2 id='relationships'>Relationships</h2>
<table><thead>
<tr>
<th>Name</th>
<th>Relationship</th>
</tr>
</thead><tbody>
<tr>
<td>Processes</td>
<td>An investment can have a variety of concurrent processes which need to be fulfilled on it.</td>
</tr>
<tr>
<td>Tasks</td>
<td>An investment can have a variety of tasks, through processes.</td>
</tr>
</tbody></table>
<h2 id='status'>Status</h2>
<p>For an investment in a deal to go through, a variety of things have to
happen.</p>

<ul>
<li>The investor must have current/valid accreditation</li>
<li>Subscription documents between the two parties must be signed</li>
<li>(Potentially) Suitability documents must be signed &amp; approved by the
investor&#39;s advisor</li>
<li>(Potentially) Money must go into escrow</li>
<li>etc</li>
</ul>

<p>All these processes need to be able to run concurrently, but in certain
circumstances they might have dependencies upon each other.</p>

<ul>
<li>Before subscription documents can be countersigned, the investor&#39;s
advisor must sign off on the suitability of the investment.</li>
</ul>

<p>In order to manage this process, an investment can have a variety of
<strong>processes</strong> required for successful completion.</p>

<p>Each <strong>process</strong> manages an ordered list of <strong>tasks</strong>, which track and
record where a given process is at.</p>

<p>In order to advance through a <strong>process</strong> for an investment, someone
might need to take an action. When this is the case, the investment will
produce <strong>notifications</strong>, or prompts that get sent up to users which
help them advance through the processes by completing the relevant task.</p>
<h3 id='process'>Process</h3><h3 id='process-template'>Process Template</h3><h3 id='process-category'>Process Category</h3><h3 id='tasks'>Tasks</h3><h3 id='notifications'>Notifications</h3><h3 id='process-options'>Process Options</h3><h1 id='developer-reference'>Developer Reference</h1>
<p>Here&#39;s a collection of things that are not well documented, and
workaround we&#39;ll have to adopt in our current system for the time being.</p>
<h2 id='using-the-right-serializer-amp-adapter'>Using the right serializer &amp; adapter</h2>
<p>Active Model Serializers have 3 available adapter. Attributes (default),
json, and json api. Since we&#39;re adhering to the json api spec, we want
to use the :json_api adapter.</p>

<p>Unfortunately, there&#39;s no way to configure this in a non-global way, so
we&#39;ll have to pass it in as an option everywhere we want to use it.</p>
<pre class="highlight ruby tab-ruby"><code><span class="n">render</span> <span class="ss">json: </span><span class="vi">@investments</span><span class="p">,</span> <span class="ss">each_serializer: </span><span class="o">::</span><span class="no">V2</span><span class="o">::</span><span class="no">InvestmentsSerializer</span><span class="p">,</span> <span class="ss">adapter: :json_api</span>
</code></pre>
<p>For the time being, we&#39;ll need to explicity pass in the v2 serializers.</p>
<h2 id='limiting-what-fields-are-sent-back'>Limiting what fields are sent back</h2><pre class="highlight ruby tab-ruby"><code><span class="n">render</span> <span class="ss">json: </span><span class="vi">@investments</span><span class="p">,</span> <span class="ss">each_serializer: </span><span class="o">::</span><span class="no">V2</span><span class="o">::</span><span class="no">InvestmentsSerializer</span><span class="p">,</span> <span class="ss">adapter: :json_api</span><span class="p">,</span> <span class="ss">fields: </span><span class="p">{</span> <span class="ss">investments: </span><span class="p">[</span><span class="ss">:titled</span><span class="p">,</span> <span class="ss">:created_at</span><span class="p">]}</span>
</code></pre>
<p>There&#39;s only one important condition here.</p>

<p>The fields method requires an argument of:</p>

<ul>
<li><code>{ obect_type: [:fields, :here] }</code></li>
</ul>

<p>The plural_resource_name needs to correspond with the &#39;type&#39; of the response. This is so AMS can figure out which json objects in your response you want to limit.</p>

<p>The type is usually the lowercase plural of the model.</p>

<ul>
<li>ex: Investment -&gt; investments.</li>
</ul>

<p>This can be either a string or a symbol.</p>
<h2 id='including-other-relationships'>Including other relationships</h2><pre class="highlight ruby tab-ruby"><code><span class="n">render</span> <span class="ss">json: </span><span class="vi">@investments</span><span class="p">,</span> <span class="ss">each_serializer: </span><span class="o">::</span><span class="no">V2</span><span class="o">::</span><span class="no">InvestmentsSerializer</span><span class="p">,</span> <span class="ss">include: </span><span class="p">[</span><span class="ss">:address</span><span class="p">]</span>
</code></pre>
<p>Include accepts a straight array of what relationships to include.</p>

<ul>
<li>ex: <code>include: [:address, :user, :other_relationship</code></li>
</ul>
<h2 id='rendering-errors'>Rendering Errors</h2>
<p><a href="https://github.com/bf4/active_model_serializers/blob/d03db81070d6e18c7191f4986bc0cc60b9dfc8a3/docs/jsonapi/errors.md">Documentation Here</a></p>
<pre class="highlight ruby tab-ruby"><code><span class="n">resource</span> <span class="o">=</span> <span class="no">Profile</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">name: </span><span class="s1">'Name 1'</span><span class="p">,</span>
                       <span class="ss">description: </span><span class="s1">'Description 1'</span><span class="p">,</span>
                       <span class="ss">comments: </span><span class="s1">'Comments 1'</span><span class="p">)</span>
<span class="n">resource</span><span class="p">.</span><span class="nf">errors</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="ss">:name</span><span class="p">,</span> <span class="s1">'cannot be nil'</span><span class="p">)</span>
<span class="n">resource</span><span class="p">.</span><span class="nf">errors</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="ss">:name</span><span class="p">,</span> <span class="s1">'must be longer'</span><span class="p">)</span>
<span class="n">resource</span><span class="p">.</span><span class="nf">errors</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="ss">:id</span><span class="p">,</span> <span class="s1">'must be a uuid'</span><span class="p">)</span>

<span class="n">render</span> <span class="ss">json: </span><span class="n">resource</span><span class="p">,</span> <span class="ss">status: </span><span class="mi">422</span><span class="p">,</span> <span class="ss">adapter: :json_api</span><span class="p">,</span> <span class="ss">serializer: </span><span class="no">ActiveModel</span><span class="o">::</span><span class="no">Serializer</span><span class="o">::</span><span class="no">ErrorSerializer</span>
<span class="c1"># #=&gt;</span>
<span class="c1">#  { :errors =&gt;</span>
<span class="c1">#    [</span>
<span class="c1">#      { :source =&gt; { :pointer =&gt; '/data/attributes/name' }, :detail =&gt; 'cannot be nil' },</span>
<span class="c1">#      { :source =&gt; { :pointer =&gt; '/data/attributes/name' }, :detail =&gt; 'must be longer' },</span>
<span class="c1">#      { :source =&gt; { :pointer =&gt; '/data/attributes/id' }, :detail =&gt; 'must be a uuid' }</span>
<span class="c1">#    ]</span>
<span class="c1">#  }.to_json</span>
</code></pre>
<p>Direct error document generation</p>
<pre class="highlight ruby tab-ruby"><code><span class="n">options</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">resource</span> <span class="o">=</span> <span class="no">ModelWithErrors</span><span class="p">.</span><span class="nf">new</span>
<span class="n">resource</span><span class="p">.</span><span class="nf">errors</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="ss">:name</span><span class="p">,</span> <span class="s1">'must be awesome'</span><span class="p">)</span>

<span class="n">serializable_resource</span> <span class="o">=</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">SerializableResource</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span>
  <span class="n">resource</span><span class="p">,</span> <span class="p">{</span>
    <span class="ss">serializer: </span><span class="no">ActiveModel</span><span class="o">::</span><span class="no">Serializer</span><span class="o">::</span><span class="no">ErrorSerializer</span><span class="p">,</span>
    <span class="ss">adapter: :json_api</span>
  <span class="p">})</span>
<span class="n">serializable_resource</span><span class="p">.</span><span class="nf">as_json</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>
<span class="c1"># #=&gt;</span>
<span class="c1"># {</span>
<span class="c1">#   :errors =&gt;</span>
<span class="c1">#     [</span>
<span class="c1">#       { :source =&gt; { :pointer =&gt; '/data/attributes/name' }, :detail =&gt; 'must be awesome' }</span>
<span class="c1">#     ]</span>
<span class="c1"># }</span>
</code></pre>
      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="json">json</a>
                <a href="#" data-language-name="ruby">ruby</a>
          </div>
      </div>
    </div>
  </body>
</html>
